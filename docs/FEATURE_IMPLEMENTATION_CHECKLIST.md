# Paste Library - 功能实施清单

> 总结当前确定要实现的功能（2026-02-06）

---

## 📋 功能清单概览

### 已确定要做的功能（9大类）

**Item 重构基础功能：**
1. **可变高度 Item 设计**
2. **标签系统替代收藏**
3. **Hover 快捷操作按钮**

**交互增强功能：**
4. **键盘导航与快捷键系统**
5. **粘贴队列（购物车模式）**
6. **抽屉式预览与编辑器**
7. **跨应用拖拽**
8. **模糊搜索增强**

**文件处理增强：**
9. **图片文件缩略图显示**

---

## 1. 可变高度 Item 设计 📐

### 文本类型
- **最多显示 3 行**，超出显示省略号
- 行高固定，确保视觉一致性
- 约可显示 60-80 个汉字

### 图片类型
- 缩略图高度 = 3 行文本高度
- 当前是小缩略图 (48x36px)，需要放大
- 保持比例缩放

### 文件类型
- 普通文件：保持单行高度
- **图片文件**：直接显示缩略图（如果可以读取）
- 显示文件名 + 文件大小

### 类型高度规范
```
文本/Html:  3 行高度 (~72px)
图片:        3 行高度 (~72px)
文件:        1 行高度 (~36px，图片文件显示缩略图)
多文件:      1 行高度
```

### 信息展示简化
**Item 上只保留最精简的信息：**
- 文本：内容预览（最多3行）+ 标签（如果有）
- 图片：缩略图 + 标签（如果有）
- 文件：图标 + 文件名 + 标签（如果有）

**Item 上不再显示的信息（移至抽屉）：**
- ❌ 字符总数
- ❌ 文件大小
- ❌ 图片尺寸
- ❌ 复制时间（可以用相对时间如"5分钟前"替代）

**好处：**
- item 列表更清爽，减少视觉干扰
- 统计信息统一在抽屉中展示，更详细
- 更多空间留给内容和标签

---

## 2. 标签系统替代收藏 🏷️

### 核心变更
- **移除 `is_favorite` 字段**
- **新增 `tags` 字段**：`string[]`
- 一个 item 可以有多个标签（如："工作"、"灵感"、"待办"）

### 标签功能
- **添加标签**：给 item 打标签 ⏳ *UI未实现（showTagManager为空）*
- **删除标签**：从 item 移除标签 ⏳ *UI未实现*
- **标签管理面板**：
  - 系统预设一套颜色 ✅ *预设颜色已定义*
  - 用户可添加/删除自定义标签 ⏳ *弹窗未实现*
  - 显示每个标签的使用数量 ⏳ *待实现*
- **搜索标签**：搜索时可直接搜索标签名 ✅ *已实现*

### UI 展示
- 标签显示在 item 底部
- 不同标签用不同颜色区分
- 标签可点击快速筛选

### 数据迁移
- 将现有的收藏数据迁移到"收藏"标签
- 收藏完全废弃，转为标签系统

---

## 3. Hover 快捷操作按钮 ⚡

### 按钮位置
- Item 右上角显示
- Hover 时淡入显示（150ms 过渡）

### 按钮功能（3个）
1. **复制** 📋 - 一键复制到剪贴板
2. **标签** 🏷️ - 快速添加/编辑标签（弹出小菜单）
3. **删除** 🗑️ - 删除 item（带确认或撤销）

### 交互细节
- 使用图标按钮，节省空间
- 触摸设备上改为长按显示
- 按钮点击阻止事件冒泡（防止触发 item 点击）

---

## 4. 键盘导航与快捷键系统 ⌨️

### 核心功能
- **上下导航**：`↑/↓` 键在 item 列表中移动选中状态
- **Enter 粘贴**：选中 item 后按 Enter 直接粘贴
- **数字快捷键**：`1-9` 键快速粘贴对应位置的 item（显示数字角标）
- **Esc 关闭**：按 Esc 关闭剪贴板窗口

### 扩展功能
- **自定义快捷键**：允许用户修改默认快捷键
- **快捷键冲突检测**：避免与系统快捷键冲突

### 视觉反馈
- 当前选中 item 高亮显示
- 数字角标显示在 item 右上角（1-9）
- 选中状态边框或背景色变化
- 配合可变高度 item 的选中效果

---

## 5. 粘贴队列（购物车模式）🛒

### 核心概念
类似购物车，可以将多个 item 拖入"粘贴盒"，然后一次性按顺序粘贴

### 功能点
- **拖拽添加**：从列表拖拽 item 到粘贴盒
- **顺序调整**：在盒内拖拽调整 item 顺序
- **分隔符选择**：
  - 换行分隔（默认）
  - 无分隔（连续粘贴）
  - 自定义分隔符（如逗号、分号）
- **一键粘贴**：合并所有内容后一次性粘贴
- **预览功能**：显示合并后的最终效果
- **清空盒子**：一键移除所有 item
- **自动清空选项**：粘贴后是否自动清空

### UI 设计
- 底部固定面板显示粘贴盒
- 显示当前 item 数量
- 可展开/收起

---

## 6. 抽屉式预览与编辑器 📝

### 文本 Item
**点击文本 item 预览→ 右侧滑出编辑抽屉**
- 显示完整文本内容（带滚动）
- **可直接编辑修改**
- **统计信息展示**：
  - 字符总数（含/不含空格）
  - 行数
  - 字节大小
- 操作按钮：
  - 复制（复制修改后的内容）
  - 直接粘贴（粘贴修改后的内容）
  - 保存为新 item（保存修改为新记录）
- 查找/替换功能

### 图片 Item
**点击图片/图片文件 item 预览→ 右侧滑出图片抽屉**
- 显示完整大图
- 支持缩放查看
- 支持拖拽移动查看
- 显示图片信息：
  - 尺寸（宽 x 高）
  - 文件大小
  - 格式（PNG/JPG 等）

### 文件 Item
- 图片文件：同图片 item 处理
- 其他文件：显示文件信息和图标

---

## 7. 跨应用拖拽 🖱️

### 功能描述
直接从剪贴板窗口拖拽 item 到其他应用程序

### 支持的场景
- **图片** → 拖入 PS/Sketch/微信/QQ
- **文本** → 拖入代码编辑器/Word/记事本
- **文件** → 拖入文件夹/桌面/邮件附件

### 技术要点
- 设置拖拽时的数据类型（文本/图片/文件）
- 拖拽时显示半透明预览
- 支持多选批量拖拽

---

## 8. 模糊搜索增强 🔍

### 搜索功能
- **拼音搜索**：输入 "gz" 匹配 "工作"
- **首字母搜索**：输入 "sj" 匹配 "设计"
- **容错搜索**：输入 "cilp" 也能匹配 "clip"
- **标签搜索**：搜索标签名匹配带标签的 item

### 搜索体验优化
- **高亮显示**：搜索结果中高亮匹配的关键词
- **实时搜索**：输入时即时过滤，无需按回车
- **搜索历史**：显示最近搜索过的关键词

---

## 9. 图片文件缩略图显示 🖼️

### 功能描述
当复制的文件是图片格式时，直接显示图片缩略图而非文件图标

### 支持的图片格式
- PNG、JPG、JPEG、GIF、WebP、BMP

### 实现方式
- 检测文件扩展名判断是否为图片
- 如果是图片，读取并生成缩略图
- 缩略图存储在 app_data/thumbnails/
- 在 item 中显示缩略图（同图片类型的高度）

### 性能考虑
- 使用虚拟滚动优化性能
- 缩略图按需生成
- 缓存已生成的缩略图

---

## 📊 优先级与依赖关系

### Phase 1: Item 基础重构（最先做）
1. **可变高度 Item** - UI 基础，影响所有 item 显示
2. **标签系统** - 数据模型基础，替代收藏功能
3. **Hover 快捷按钮** - 交互基础，提升操作效率

### Phase 2: 核心交互增强
4. **键盘导航** - 基础交互，提升效率
5. **粘贴队列** - 批量处理功能
6. **抽屉式编辑器** - 深度编辑功能

### Phase 3: 高级功能
7. **跨应用拖拽** - 系统集成（复杂度高）
8. **模糊搜索** - 增强查找能力（需标签系统支持）
9. **图片文件缩略图** - 文件处理增强

### 依赖关系
- 可变高度 Item → Hover 按钮位置调整
- 标签系统 → 模糊搜索（标签搜索）
- 键盘导航 → 数字快捷键显示
- 抽屉编辑器 → 图片大图预览
- 可变高度 Item → 键盘导航（选中高亮样式）

---

## 📝 待确认事项

在正式开始实施前，需要确认以下问题：

### Item 重构相关
1. **可变高度 Item**
   - 文本类型：最多3行，超出用省略号还是渐变遮罩？
   - 图片类型：固定3行高度，宽度自适应还是裁剪？
   - 图片文件缩略图：所有图片格式都支持，还是只支持常见格式？

2. **标签系统**
   - 系统预设标签有哪些？（如：工作、个人、待办、灵感）
   - 预设颜色方案？（建议8-10个颜色）
   - 标签显示在 item 底部还是右上角？
   - 一个 item 最多几个标签？

3. **Hover 按钮**
   - 按钮图标样式？（线框/填充）
   - 按钮大小？（24x24px？）
   - 删除是否需要二次确认？

### 键盘导航相关
4. **数字快捷键显示**
   - 是否在 item 上直接显示 1-9 数字角标？
   - 超过 9 个 item 怎么办？（只显示前9个？）

### 其他功能
5. **粘贴盒位置**
   - 固定在底部？
   - 还是可浮动的面板？

6. **抽屉方向**
   - 从右侧滑出？
   - 还是从底部弹出？

7. **图片预览**
   - 图片 drawer 中是否需要编辑功能？
   - 还是纯预览？

8. **模糊搜索范围**
   - 只搜索文本内容？
   - 还是包括标签、文件名等？

---

## ✅ Checklist

实施前准备：
- [ ] 确认上述 9 个功能的详细规格
- [ ] 确认待确认事项
- [ ] 设计 UI 原型（可选）
- [ ] 评估各功能开发工作量

实施顺序建议：

**Phase 1: Item 基础重构（Foundation）**
- [x] 1.1 可变高度 Item 设计（文本3行、图片3行高度）
- [~] 1.2 标签系统替代收藏（数据模型✅ UI部分⏳）
  - [x] 数据模型（tags字段、Tag类型定义）
  - [x] 后端API（update_tags、get_all_tags）
  - [x] 标签显示（Item底部显示已有标签）
  - [x] 收藏功能迁移（使用"收藏"标签）
  - [ ] **标签管理弹窗**（添加/删除标签UI）⏳ **待实现**
  - [ ] 标签筛选（除收藏外的其他标签筛选）
- [x] 1.3 Hover 快捷操作按钮（复制、标签、删除）

**Phase 2: 核心交互增强（Core）**
- [ ] 2.1 键盘导航系统（↑↓、Enter、数字键1-9、Esc）
- [ ] 2.2 粘贴队列（购物车模式、批量粘贴）
- [ ] 2.3 抽屉式编辑器（文本编辑、图片预览）

**Phase 3: 高级功能（Advanced）**
- [ ] 3.1 跨应用拖拽
- [ ] 3.2 模糊搜索（拼音、首字母、容错、标签搜索）
- [ ] 3.3 图片文件缩略图显示

---

## 📈 功能统计

| 阶段 | 功能数量 | 复杂度 |
|------|---------|--------|
| Phase 1: Item 基础重构 | 3 | 中 |
| Phase 2: 核心交互增强 | 3 | 中-高 |
| Phase 3: 高级功能 | 3 | 高 |
| **总计** | **9** | - |

---

*最后更新: 2026-02-06*
